<!-- ============================================================================
Project   : gratulo
Module    : frontend/templates/partials/admin_user_editor.html
Created   : 2025-10-15
Author    : ChatGPT (based on Florian’s UI style)
Purpose   : Partial for creating/editing admin users (2FA ready)
============================================================================ -->

<div class="bg-white rounded-lg shadow p-4">
  <form
    hx-post="/mailer-config/admin-users/save"
    hx-target="#admin-users-section"
    hx-swap="innerHTML"
    class="space-y-6"
  >
    {% if user %}
      <input type="hidden" name="user_id" value="{{ user.id }}">
    {% endif %}

    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <!-- Benutzername -->
      <div>
        <label class="block text-sm font-medium text-gray-700">Benutzername</label>
        <input
          type="text"
          name="username"
          value="{{ user.username if user else '' }}"
          required
          class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"
        >
      </div>

      <!-- Passwort -->
      <div>
        <label class="block text-sm font-medium text-gray-700">Passwort</label>
        <input
          type="password"
          name="password"
          placeholder="{% if user %}Leer lassen, um Passwort zu behalten{% else %}••••••••{% endif %}"
          class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"
        >
        {% if user %}
          <p class="text-xs text-gray-500 mt-1">Leer lassen, um das aktuelle Passwort zu behalten.</p>
        {% endif %}
      </div>

      <!-- 2FA aktiviert -->
      <div>
        <label class="flex items-center mt-6">
          <input
            type="checkbox"
            name="is_2fa_enabled"
            value="true"
            {% if user and user.is_2fa_enabled %}checked{% endif %}
            class="rounded border-gray-300 text-indigo-600 shadow-sm focus:ring-indigo-500"
          >
          <span class="ml-2 text-sm text-gray-700">Zwei-Faktor-Authentifizierung aktivieren</span>
        </label>
        <p class="text-xs text-gray-500 mt-1">
          Beim Deaktivieren wird das vorhandene 2FA-Secret unwiderruflich gelöscht.
          Eine erneute Aktivierung erzeugt ein neues Secret und einen neuen QR-Code.
        </p>
      </div>

      <!-- Aktiv -->
      <div>
        <label class="flex items-center mt-6">
          <input
            type="checkbox"
            name="is_active"
            value="true"
            {% if not user or user.is_active %}checked{% endif %}
            class="rounded border-gray-300 text-indigo-600 shadow-sm focus:ring-indigo-500"
          >
          <span class="ml-2 text-sm text-gray-700">Aktiv</span>
        </label>
      </div>
    </div>

    <!-- Aktionen -->
    <div class="flex justify-end gap-3 mt-8">
      <button
        type="button"
        hx-get="/mailer-config/admin-users"
        hx-target="#admin-users-section"
        hx-swap="innerHTML"
        class="px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-400 transition"
      >
        Abbrechen
      </button>

      <button
        type="submit"
        class="px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition"
      >
        {% if user %}Speichern{% else %}Anlegen{% endif %}
      </button>
    </div>

  </form>
</div>
